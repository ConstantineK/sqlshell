$names = @(
    'Microsoft.SqlServer.BatchParser',
    'Microsoft.SqlServer.BatchParserClient',
    'Microsoft.SqlServer.BulkInsertTaskConnections',
    'Microsoft.SqlServer.DTSRuntimeWrap',
    'Microsoft.SqlServer.DtsServer.Interop',
    'Microsoft.SqlServer.DTSUtilities',
    'Microsoft.SqlServer.ForEachFileEnumeratorWrap',
    'Microsoft.SqlServer.ManagedDTS',
    'Microsoft.SqlServer.IntegrationServices.ODataConnectionManager',
    'Microsoft.SqlServer.IntegrationServices.ODataSrc',
    'Microsoft.SqlServer.PipelineHost',
    'Microsoft.SqlServer.PackageFormatUpdate',
    'Microsoft.SqlServer.Replication',
    'Microsoft.SqlServer.SqlCEDest',
    'Microsoft.SqlServer.SQLTask',
    'Microsoft.SqlServer.TxScript',
    'Microsoft.SqlServer.XmlSrc',
    'Microsoft.SqlServer.Rmo',
    'Microsoft.SqlServer.DTSPipelineWrap',
    'Microsoft.SqlServer.ScriptTask',
    'Microsoft.Azure.KeyVault.Core',
    'Microsoft.Data.Edm',
    'Microsoft.Data.OData',
    'Microsoft.Practices.TransientFaultHandling.Core',
    'Microsoft.DataTransfer.Common.Utils',
    'Microsoft.SqlServer.ASTasks',
    'Microsoft.SqlServer.ConnectionInfo',
    'Microsoft.SqlServer.ConnectionInfoExtended',
    'Microsoft.SqlServer.DataProfiler',
    'Microsoft.SqlServer.DataProfilingTask',
    'Microsoft.SqlServer.Diagnostics.STrace',
    'Microsoft.SqlServer.Dmf.Common',
    'Microsoft.SqlServer.Dmf',
    'Microsoft.SqlServer.DMQueryTask',
    'Microsoft.SqlServer.DTEnum',
    'Microsoft.SqlServer.Dts.Design',
    'Microsoft.SqlServer.Dts.DtsClient',
    'Microsoft.SqlServer.DtsMsg',
    'Microsoft.SqlServer.Edition',
    'Microsoft.SqlServer.ExecProcTask',
    'Microsoft.SqlServer.ExpressionTask',
    'Microsoft.SqlServer.FileSystemTask',
    'Microsoft.SqlServer.ForEachADOEnumerator',
    'Microsoft.SqlServer.ForEachFromVarEnumerator',
    'Microsoft.SqlServer.ForEachNodeListEnumerator',
    'Microsoft.SqlServer.ForEachSMOEnumerator',
    'Microsoft.SqlServer.FtpTask',
    'Microsoft.SqlServer.GridControl',
    'Microsoft.SqlServer.Instapi',
    'Microsoft.SqlServer.IntegrationServices.ClusterManagement',
    'Microsoft.SqlServer.IntegrationServices.Common.ObjectModel',
    'Microsoft.SqlServer.IntegrationServices.ISServerDBUpgrade',
    'Microsoft.SqlServer.IntegrationServices.Server.Common',
    'Microsoft.SqlServer.IntegrationServices.Server',
    'Microsoft.SqlServer.IntegrationServices.Server.IPC',
    'Microsoft.SqlServer.IntegrationServices.server.shared',
    'Microsoft.SqlServer.IntegrationServices.TaskScheduler',
    'Microsoft.SqlServer.ManagedConnections',
    'Microsoft.SqlServer.Management.Collector',
    'Microsoft.SqlServer.Management.CollectorEnum',
    'Microsoft.SqlServer.Management.CollectorTasks',
    'Microsoft.SqlServer.Management.HadrDMF',
    'Microsoft.SqlServer.Management.HelpViewer',
    'Microsoft.SqlServer.Management.IntegrationServices',
    'Microsoft.SqlServer.Management.IntegrationServicesEnum',
    'Microsoft.SqlServer.Management.RegisteredServers',
    'Microsoft.SqlServer.Management.Sdk.Sfc',
    'Microsoft.SqlServer.Management.SmartAdminPolicies',
    'Microsoft.SqlServer.Management.SqlParser',
    'Microsoft.SqlServer.Management.SystemMetadataProvider',
    'Microsoft.SqlServer.Management.Utility',
    'Microsoft.SqlServer.Management.UtilityEnum',
    'Microsoft.SqlServer.Management.XEvent',
    'Microsoft.SqlServer.Management.XEventDbScoped',
    'Microsoft.SqlServer.Management.XEventDbScopedEnum',
    'Microsoft.SqlServer.Management.XEventEnum',
    'Microsoft.SqlServer.MSMQTask',
    'Microsoft.SqlServer.PipelineXML',
    'Microsoft.SqlServer.PolicyEnum',
    'Microsoft.SqlServer.RegSvrEnum',
    'Microsoft.SqlServer.Replication.BusinessLogicSupport',
    'Microsoft.SqlServer.SendMailTask',
    'Microsoft.SqlServer.ServiceBrokerEnum',
    'Microsoft.SqlServer.Smo',
    'Microsoft.SqlServer.SmoExtended',
    'Microsoft.SqlServer.SqlClrProvider',
    'Microsoft.SqlServer.SqlEnum',
    'Microsoft.SqlServer.SQLTaskConnectionsWrap',
    'Microsoft.SqlServer.SqlTDiagm',
    'Microsoft.SqlServer.SqlWmiManagement',
    'Microsoft.SqlServer.SString',
    'Microsoft.SqlServer.TransferDatabasesTask',
    'Microsoft.SqlServer.TransferErrorMessagesTask',
    'Microsoft.SqlServer.TransferJobsTask',
    'Microsoft.SqlServer.TransferLoginsTask',
    'Microsoft.SqlServer.TransferObjectsTask',
    'Microsoft.SqlServer.TransferSqlServerObjectsTask',
    'Microsoft.SqlServer.TransferStoredProceduresTask',
    'Microsoft.SqlServer.Types',
    'Microsoft.SqlServer.Types.resources',
    'Microsoft.SqlServer.VSTAScriptingLib',
    'Microsoft.SqlServer.WebServiceTask',
    'Microsoft.SqlServer.WMIDRTask',
    'Microsoft.SqlServer.WmiEnum',
    'Microsoft.SqlServer.WMIEWTask',
    'Microsoft.SqlServer.XMLTask',
    'Microsoft.SqlServer.Dmf.Adapters',
    'Microsoft.SqlServer.DmfSqlClrWrapper'
)
$ErrorActionPreference = "Stop"
$Root = $script:PSModuleRoot
if (-not $Root){
  # If we don't detect a module root, assume we are running this individually in our directory structre
  Write-Verbose $script:PSScriptRoot
  $Root = $script:PSScriptRoot | Split-Path | Split-Path
}
if (-not $Root){
  throw "Could not bind the current folder to import smo libraries."
}
foreach ($name in $names) {
  Add-Type -Path (Join-Path $Root "bin" | Join-Path -ChildPath "smo" | Join-Path -ChildPath "$name.dll") -ErrorAction Stop
}